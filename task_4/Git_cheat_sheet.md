# Шпаргалка по git

## Основные команды
1. Создать локальный репозиторий  
    ```bash
    git init
    ```
1. Показать статус локального репозитория  
    ```bash
    git status
    ```
1. Добавить всё содержимое текущего каталога в индекс  
    ```bash
    git add .
    ```
    Добавить в индекс файл: `git add <file>`  
    Добавить в индекс директорию: `git add <directory>`  
    **Флаги:**
    - `-A` Добавить в индекс содержимое всего проекта, начиная с корневой директории
    - `-p` При использовании этого флага для каждого фрагмента изменений в файле можно будет выбрать, добавлять его в индекс, или нет.
1. Создать коммит  
    ```bash
    git commit -m '<текст комментария>'
    ```
    Если указать путь к файлу или директории, то можно миновать этап добавления в индекс:
    ```bash
    git commit -m '<текст комментария>' <путь>
    ```
    **Флаги:**
    - `-m` При использовании данного флага текстовый редактор не открывается, а комментарий указывается в тексте команды.
    - `-a` Этот флаг позволяет миновать этап добавления в индекс (`git add`). Неослеживаемые файлы игнорируются без предупреждения
    - `--amend` Вместо создания нового коммита проиндексированные изменения будут добавлены в предыдущий коммит

## Просмотр истории  
Показать коммит:  
```bash
git show <id коммита>
```
Показать историю коммитов:  
```bash
git log
```

## Работа с индексом
Файл gitignore позволяет указать файлы и директории, которые следует игнорировать про добавлении изменений в индекс.

Правила синтаксиса:
 1. Одна строка = одно правило
 1. \# - комментирует строку
 1. Пустые строки игнорируются
 1. / - путь к файлу или директории, начинающийся с текущего местоположения (то есть с того места, где лежит файл gitignore)
 1. \* - 0 и более любых символов
 1. ? - 0 символов или 1 символ
 1. /\*\*/ - любые папки
 1. ! - логическое "НЕ", применяется для исключения файлов и папок из общих правил
 1. \ - экранирование символов
 1. Для игнорирования всей директорий правило должно оканчиваться на слеш, иначе гит будет думать что это название файла.

Сбросить изменения в индексе для файла или директории:  
```bash
git reset HEAD <путь>
```

## Переименование и удаление
Операции переименования и удаления не требуют особых команд. Можно сделать изменения в рабочей директории и добавить их в индекс.

Однако могут быть полезными следующие команды:

- Удаление файла и добавление изменения в индекс:
	```bash
    git rm <путь>
    ```
    Для директории требуется флаг `-r`.  
    Чтобы удалить из индекса, но оставить в рабочей директории, используется флаг `-cached`.  
- Переименование с добавлением в индекс:
    ```bash
    git mv <путь>
    ```

## Добавление SSH-ключа
### Создание ключа
```bash
ssh-keygen -t ed25519 -C "your_email@example.com"
```
Парольную фразу можно оставить пустой.  
```bash
eval "$(ssh-agent -s)"
```
```bash
open ~/.ssh/config
```
Если файл не существует, создайте его:  
```bash
touch ~/.ssh/config
```
Измените файл, чтобы он содержал следующие строки:
```
Host github.com
  AddKeysToAgent yes
  UseKeychain yes
  IdentityFile ~/.ssh/id_ed25519
```
```bash
ssh-add --apple-use-keychain ~/.ssh/id_ed25519
```

[Подробнее здесь](https://docs.github.com/ru/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent)

### Добавление ключа в githab
```bash
pbcopy < ~/.ssh/id_ed25519.pub
```
Не изменяйте скопированный фрагмент, не удаляйте пробелы и перевод строки в конце.

На гитхабе:
1. Нажать но фото профиля в правом верхнем углу  
1. Settings => Access => SSH and GPG keys  
1. Добавить ключ отдельно для аутентификации и отдельно для подписи  

[Подробнее здесь](https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account)
